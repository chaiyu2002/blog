<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="一个IT老兵的驿站，记录下来过去的，当前的所有想表达的东西。"><title>Git：git diff发现windows下会出现&quot;^M&quot;符号 | 老兵驿站</title><link rel="stylesheet" type="text/css" href="//fonts.neworld.org/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style.css?v=2.0.1"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=2.0.1"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script src="https://s13.cnzz.com/z_stat.php?id=1273963895&amp;web_id=1273963895"></script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Git：git diff发现windows下会出现&quot;^M&quot;符号</h1><a id="logo" href="/.">老兵驿站</a><p class="description">一个IT老兵的驿站</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="linux"></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">Git：git diff发现windows下会出现&quot;^M&quot;符号</h1><div class="post-meta"><a href="/git/git-diff-m-symbol.html#comments" class="comment-count"></a><p><span class="date">Jul 28, 2018</span><span><a href="/categories/Git/" class="category">Git</a></span><span><i id="busuanzi_container_page_pv"><i id="busuanzi_value_page_pv"></i><i>点击</i></i></span></p></div><div class="post-content"><p>原帖收藏于IT老兵驿站，传递一个IT老兵凋零前的光和氧。</p>
<p>Git：git diff发现windows下会出现”^M”符号。<br><a id="more"></a></p>
<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>在不同操作系统上编译Git仓库的文件，经常在<code>git diff</code> 时发现很多文件的变化是尾部多了一个<code>^M</code> 的符号。这给工作带来很多困扰，研究一下这个问题。</p>
<h1 id="正题"><a href="#正题" class="headerlink" title="正题"></a>正题</h1><p>翻到这个<a href="https://stackoverflow.com/questions/1889559/git-diff-to-ignore-m" target="_blank" rel="noopener">帖子</a>：</p>
<blockquote>
<p><a href="https://help.github.com/articles/dealing-with-line-endings/" target="_blank" rel="noopener">GitHub</a> suggests that you should make sure to only use \n as a newline character in git-handled repos. There’s an option to auto-convert:</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git config --global core.autocrlf true</span><br></pre></td></tr></table></figure>
<p>大体翻译：GitHub建议你应该只用<code>\n</code> 来做为新行的开始，用上面那样的设置就可以做到自动的转换，这样也就解决了问题，Git不会再报告差异。</p>
<p>那这是为什么呢？</p>
<p>阅读一下这里所介绍的这个帖子。</p>
<blockquote>
<p>If you’re using Git to collaborate with others on GitHub, ensure that Git is properly configured to handle line endings.</p>
</blockquote>
<blockquote>
<p>Every time you press return on your keyboard you’re actually inserting an invisible character called a line ending. Historically, different operating systems have handled line endings differently.</p>
</blockquote>
<blockquote>
<p>When you view changes in a file, Git handles line endings in its own way. Since you’re collaborating on projects with Git and GitHub, Git might produce unexpected results if, for example, you’re working on a Windows machine, and your collaborator has made a change in OS X.</p>
</blockquote>
<p>这里大概是说每个操作系统有自己的换行符（就是当你按下”回车”后，系统会自动插入一些不可见的符号来表示一行的结束），<code>Linux</code>和<code>Mac</code>都是使用<code>LF</code> ，<code>Windows</code> 则是<code>CRLF</code> ，这样就造成了差异。</p>
<p>Git会对此进行一些处理，但是做什么处理呢？这里没有说清楚，只是说要用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config core.autocrlf</span><br></pre></td></tr></table></figure>
<p>来控制，和上面说的是一样的，但是原理还是没有搞明白。</p>
<p>只好来看<a href="https://git-scm.com/docs/git-config" target="_blank" rel="noopener">官网</a>。</p>
<blockquote>
<p>core.autocrlf<br>Setting this variable to “true” is the same as setting the text attribute to “auto” on all files and core.eol to “crlf”. Set to true if you want to have CRLF line endings in your working directory and the repository has LF line endings. This variable can be set to input, in which case no output conversion is performed.</p>
</blockquote>
<p>这个变量设置为<code>true</code> 等同于在所有文件上设置<code>text attribute</code> 为<code>auto</code> 并且把<code>core.eol</code> 设置为<code>crlf</code>。设成<code>true</code> ， 如果你的工作空间用的是<code>CRLF</code> 作为行结束符，同时仓库用的是<code>LF</code> 行结束符。这个变量也可以设置成<code>input</code>，这样在输出时就不做转换了。</p>
<p>对上面说的<code>core.eol</code> 又不明白了，继续查看：</p>
<blockquote>
<p>core.eol<br>Sets the line ending type to use in the working directory for files that have the text property set when core.autocrlf is false. Alternatives are lf, crlf and native, which uses the platform’s native line ending. The default value is native. See gitattributes[5] for more information on end-of-line conversion.</p>
</blockquote>
<p>这个变量是用来设置行结束符的，在<code>core.autocrlf</code> 是<code>false</code>的时候。可以设置成<code>lf</code>，<code>crlf</code>和<code>native</code> ， <code>native</code>是说使用当前平台自己的行结束符。</p>
<p>到这里，大体就明白了，还留有一个问题，就是<code>attribute</code>的问题，留在下一次来研究。</p>
</div><div class="tags"><a href="/tags/Git/">Git</a></div><div class="post-share"><div class="bdsharebuttonbox"><span style="float:left;line-height: 28px;height: 28px;font-size:16px;font-weight:blod">分享到：</span><a href="#" data-cmd="more" class="bds_more"></a><a href="#" data-cmd="mshare" title="分享到一键分享" class="bds_mshare"></a><a href="#" data-cmd="fbook" title="分享到Facebook" class="bds_fbook"></a><a href="#" data-cmd="twi" title="分享到Twitter" class="bds_twi"></a><a href="#" data-cmd="linkedin" title="分享到linkedin" class="bds_linkedin"></a><a href="#" data-cmd="youdao" title="分享到有道云笔记" class="bds_youdao"></a><a href="#" data-cmd="evernotecn" title="分享到印象笔记" class="bds_evernotecn"></a><a href="#" data-cmd="weixin" title="分享到微信" class="bds_weixin"></a><a href="#" data-cmd="qzone" title="分享到QQ空间" class="bds_qzone"></a><a href="#" data-cmd="tsina" title="分享到新浪微博" class="bds_tsina"></a></div></div><div class="post-nav"><a href="/java/java-springmvc-X-Frame-Options.html" class="pre">Java：“目标服务器没有返回一个X-Frame-Options头”的解决方案</a><a href="/linux/shell-command-which.html" class="next">Linux下shell命令用法及常见用例：which</a></div><div id="comments"></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="search-pla"></div><div id="toc" class="widget"><div class="widget-title"><i class="fa fa-fei">文章目录</i></div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#前言"><span class="toc-text">前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#正题"><span class="toc-text">正题</span></a></li></ol></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/java/java-springmvc-X-Frame-Options.html">Java：“目标服务器没有返回一个X-Frame-Options头”的解决方案</a></li><li class="post-list-item"><a class="post-list-link" href="/git/git-diff-m-symbol.html">Git：git diff发现windows下会出现"^M"符号</a></li><li class="post-list-item"><a class="post-list-link" href="/linux/shell-command-which.html">Linux下shell命令用法及常见用例：which</a></li><li class="post-list-item"><a class="post-list-link" href="/git/git-remote-set-url.html">Git：修改远程仓库地址</a></li><li class="post-list-item"><a class="post-list-link" href="/git/git-revert.html">Git：revert的使用</a></li><li class="post-list-item"><a class="post-list-link" href="/blockchain/mongodb-collection-aggregation-introduction.html">区块链：教程 | 以太坊智能合约编程之菜鸟教程</a></li><li class="post-list-item"><a class="post-list-link" href="/mongodb/mongodb-collection-delete.html">MongoDB的基本操作：删除记录（删）</a></li><li class="post-list-item"><a class="post-list-link" href="/js/js-logical-operator.html">JS：逻辑操作符“||”、“&&”和“!”</a></li><li class="post-list-item"><a class="post-list-link" href="/thinking in programmer life/full-stack-programmer.html">程序员晋升之路：生存意识、服务意识--IT老兵的心得</a></li><li class="post-list-item"><a class="post-list-link" href="/git/git-checkout-1.html">Git：checkout的用法（1）</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-gui"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Blockchain/">Blockchain</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/CSS/">CSS</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Git/">Git</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/">JavaScript</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">8</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/Shell/">Shell</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/Ubuntu/">Ubuntu</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/MongoDB/">MongoDB</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/程序人生/">程序人生</a><span class="category-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> 标签</i></div><div class="tagcloud"><a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/Git/" style="font-size: 15px;">Git</a> <a href="/tags/Blockchain/" style="font-size: 15px;">Blockchain</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/JS-逻辑操作符/" style="font-size: 15px;">JS,逻辑操作符</a> <a href="/tags/MongoDB/" style="font-size: 15px;">MongoDB</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> 归档</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">七月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">六月 2018</a></li></ul></div></div></div></div><a id="totop" href="#top"></a><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">Baidu Site Haritası</a> |  <a href="/atom.xml">订阅</a> |  <a href="/about/">关于</a></p><p>本站总访问量：<i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>次</p><p><span> Copyright &copy;<a href="/." rel="nofollow">荒于嬉.</a></span><span> Theme by<a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> BlueLake.</a></span><span> Count by<a href="http://busuanzi.ibruce.info/"> busuanzi.</a></span><span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></span></p></div></div></div><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-120983285-1','auto');ga('send','pageview');
</script><script type="text/javascript" src="/js/search.json.js?v=2.0.1"></script><script type="text/javascript" src="/js/toctotop.js?v=2.0.1" async></script><script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":["mshare","weixin","tsina","qzone","linkedin","fbook","twi","print","renren","sqq","evernotecn","bdysc","tqq","tqf","bdxc","kaixin001","tieba","douban","bdhome","thx","ibaidu","meilishuo","mogujie","diandian","huaban","duitang","hx","fx","youdao","sdo","qingbiji","people","xinhua","mail","isohu","yaolan","wealink","ty","iguba","h163","copy"],"bdPic":"","bdStyle":"1","bdSize":"16"},"share":{},"image":{"viewList":["tsina","qzone","weixin","fbook","twi","linkedin","youdao","evernotecn","mshare"],"viewText":"分享到：","viewSize":"16"},"selectShare":{"bdContainerClass":null,"bdSelectMiniList":["tsina","qzone","weixin","fbook","twi","linkedin","youdao","evernotecn","mshare"]}};with(document)0[(getElementsByTagName('head')[0]||head).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
</script></body></html>